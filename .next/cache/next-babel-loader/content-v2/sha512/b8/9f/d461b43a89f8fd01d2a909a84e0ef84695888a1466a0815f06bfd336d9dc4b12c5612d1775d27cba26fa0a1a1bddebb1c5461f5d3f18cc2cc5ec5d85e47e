{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { DataStore, Predicates, SortDirection } from \"aws-amplify\";\nimport { useState, useEffect } from \"react\";\nimport { Reviews } from \"../media/models\";\nimport { useRouter } from \"next/router\";\nimport Pagin from \"../components/utils/pagination\";\nimport { Grid } from \"@material-ui/core\";\nimport Backdrop from \"../components/loader/backdrop\";\nexport default function FetchReviews() {\n  const router = useRouter();\n  let path = router.asPath;\n  const {\n    0: reviews,\n    1: setReviews\n  } = useState([]);\n  const {\n    0: pageIndex,\n    1: setPageIndex\n  } = useState(0);\n  const {\n    0: returned,\n    1: setReturned\n  } = useState(true);\n  useEffect(() => {\n    fetchPosts();\n\n    async function fetchPosts() {\n      if (path === \"/\") {\n        const reviewsData = await DataStore.query(Reviews, Predicates.ALL, {\n          page: 0,\n          limit: 5\n        }, {\n          sort: s => s.review(SortDirection.ASCENDING)\n        });\n        setReviews(reviewsData);\n      } else {\n        const reviewsData = await DataStore.query(Reviews, Predicates.ALL, {\n          page: pageIndex,\n          limit: 10\n        }, {\n          sort: s => s.review(SortDirection.ASCENDING)\n        });\n\n        if (reviewsData.length < 1) {\n          setReturned(false);\n        } else {\n          setReviews(reviewsData);\n        }\n      }\n    }\n\n    const subscription = DataStore.observe(Reviews).subscribe(() => fetchPosts());\n    return () => subscription.unsubscribe();\n  }, [pageIndex]);\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [reviews.length < 1 && returned === true && /*#__PURE__*/_jsx(_Fragment, {\n      children: /*#__PURE__*/_jsx(Backdrop, {})\n    }), reviews.length < 1 && returned === false && /*#__PURE__*/_jsx(_Fragment, {\n      children: /*#__PURE__*/_jsx(Custom404Component, {})\n    }), path === \"/\" && /*#__PURE__*/_jsx(_Fragment, {\n      children: reviews.map((review, i) => {\n        return /*#__PURE__*/_jsx(_Fragment, {\n          children: i === 0 || i === 1 ? /*#__PURE__*/_jsxs(_Fragment, {\n            children: [/*#__PURE__*/_jsx(\"sl-details\", {\n              summary: `${review.name}`,\n              open: true,\n              children: /*#__PURE__*/_jsx(\"p\", {\n                children: review.review\n              })\n            }, i), /*#__PURE__*/_jsx(\"br\", {})]\n          }) : /*#__PURE__*/_jsxs(_Fragment, {\n            children: [/*#__PURE__*/_jsx(\"sl-details\", {\n              summary: `${review.name}`,\n              children: /*#__PURE__*/_jsx(\"p\", {\n                children: review.review\n              })\n            }, i), /*#__PURE__*/_jsx(\"br\", {})]\n          })\n        });\n      })\n    }), path === \"/reviews\" && /*#__PURE__*/_jsx(_Fragment, {\n      children: reviews.map((review, i) => {\n        return /*#__PURE__*/_jsxs(_Fragment, {\n          children: [/*#__PURE__*/_jsx(\"sl-details\", {\n            summary: `${review.name}`,\n            open: true,\n            children: /*#__PURE__*/_jsx(\"p\", {\n              children: review.review\n            })\n          }, i), /*#__PURE__*/_jsx(\"br\", {})]\n        });\n      })\n    }), path !== \"/\" && /*#__PURE__*/_jsx(Grid, {\n      item: true,\n      xs: 12,\n      md: 12,\n      children: /*#__PURE__*/_jsx(Pagin, {\n        pageCount: 3,\n        pageIndex: pageIndex,\n        setPageIndex: setPageIndex\n      })\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}