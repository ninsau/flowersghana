{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"/Users/mac/codespace/flowerghana/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/mac/codespace/flowerghana/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { DataStore, Predicates, SortDirection } from \"aws-amplify\";\nimport { useState, useEffect } from \"react\";\nimport { Reviews } from \"../media/models\";\nimport { useRouter } from \"next/router\";\nimport Pagin from \"../components/utils/pagination\";\nimport { Grid } from \"@material-ui/core\";\nimport Backdrop from \"../components/loader/backdrop\";\nexport default function FetchReviews() {\n  var router = useRouter();\n  var path = router.asPath;\n\n  var _useState = useState([]),\n      reviews = _useState[0],\n      setReviews = _useState[1];\n\n  var _useState2 = useState(0),\n      pageIndex = _useState2[0],\n      setPageIndex = _useState2[1];\n\n  var _useState3 = useState(true),\n      returned = _useState3[0],\n      setReturned = _useState3[1];\n\n  useEffect(function () {\n    fetchPosts();\n\n    function fetchPosts() {\n      return _fetchPosts.apply(this, arguments);\n    }\n\n    function _fetchPosts() {\n      _fetchPosts = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var reviewsData, _reviewsData;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!(path === \"/\")) {\n                  _context.next = 7;\n                  break;\n                }\n\n                _context.next = 3;\n                return DataStore.query(Reviews, Predicates.ALL, {\n                  page: 0,\n                  limit: 5\n                }, {\n                  sort: function sort(s) {\n                    return s.review(SortDirection.ASCENDING);\n                  }\n                });\n\n              case 3:\n                reviewsData = _context.sent;\n                setReviews(reviewsData);\n                _context.next = 11;\n                break;\n\n              case 7:\n                _context.next = 9;\n                return DataStore.query(Reviews, Predicates.ALL, {\n                  page: pageIndex,\n                  limit: 10\n                }, {\n                  sort: function sort(s) {\n                    return s.review(SortDirection.ASCENDING);\n                  }\n                });\n\n              case 9:\n                _reviewsData = _context.sent;\n\n                if (_reviewsData.length < 1) {\n                  setReturned(false);\n                } else {\n                  setReviews(_reviewsData);\n                }\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n      return _fetchPosts.apply(this, arguments);\n    }\n\n    var subscription = DataStore.observe(Reviews).subscribe(function () {\n      return fetchPosts();\n    });\n    return function () {\n      return subscription.unsubscribe();\n    };\n  }, [pageIndex]);\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [reviews.length < 1 && returned === true && /*#__PURE__*/_jsx(_Fragment, {\n      children: /*#__PURE__*/_jsx(Backdrop, {})\n    }), reviews.length < 1 && returned === false && /*#__PURE__*/_jsx(_Fragment, {\n      children: /*#__PURE__*/_jsx(Custom404Component, {})\n    }), path === \"/\" && /*#__PURE__*/_jsx(_Fragment, {\n      children: reviews.map(function (review, i) {\n        return /*#__PURE__*/_jsx(_Fragment, {\n          children: i === 0 || i === 1 ? /*#__PURE__*/_jsxs(_Fragment, {\n            children: [/*#__PURE__*/_jsx(\"sl-details\", {\n              summary: \"\".concat(review.name),\n              open: true,\n              children: /*#__PURE__*/_jsx(\"p\", {\n                children: review.review\n              })\n            }, i), /*#__PURE__*/_jsx(\"br\", {})]\n          }) : /*#__PURE__*/_jsxs(_Fragment, {\n            children: [/*#__PURE__*/_jsx(\"sl-details\", {\n              summary: \"\".concat(review.name),\n              children: /*#__PURE__*/_jsx(\"p\", {\n                children: review.review\n              })\n            }, i), /*#__PURE__*/_jsx(\"br\", {})]\n          })\n        });\n      })\n    }), path === \"/reviews\" && /*#__PURE__*/_jsx(_Fragment, {\n      children: reviews.map(function (review, i) {\n        return /*#__PURE__*/_jsxs(_Fragment, {\n          children: [/*#__PURE__*/_jsx(\"sl-details\", {\n            summary: \"\".concat(review.name),\n            open: true,\n            children: /*#__PURE__*/_jsx(\"p\", {\n              children: review.review\n            })\n          }, i), /*#__PURE__*/_jsx(\"br\", {})]\n        });\n      })\n    }), path !== \"/\" && /*#__PURE__*/_jsx(Grid, {\n      item: true,\n      xs: 12,\n      md: 12,\n      children: /*#__PURE__*/_jsx(Pagin, {\n        pageCount: 3,\n        pageIndex: pageIndex,\n        setPageIndex: setPageIndex\n      })\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}